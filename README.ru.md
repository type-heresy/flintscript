# Синтаксис

## Ключевые слова
+ `reversed` - помечает слово обращенным, пример

```
reversed alias actual-word
```

На этапе парсинга `a b c d alias e f g` превратится в
`a b c d e actual-word f g`.

+ `[ someting ]` - цитирование

## Литералы

Всякий терм это

+ Слово
+ Морфизм

Все слова разрешаются вокабулярами. Цитирования - это слова. Числа - это
слова. Они в любом случае будут разрешаться вокабуляром.

Морфизм изменяет состояние. Всё. Литералов нет.

## Идентификаторы

+ `/foo/bar/.../baz` - абсолютный идентификатор.
+ `./foo/bar` - относительный идентификатор.
+ `foo` - относительный идентификатор.

Технически идентификаторы - это просто список строк, но это не точно.

# Модель исполнения

## Глобальное состояние

По умолчанию стек.

## Морфизмы состояния

Так-то это просто функция `stack -> stack`. Когда слово выполняется, оно
просто достает из вокабуляра морфизм, и применяет его к глобальному состоянию.

## Вокабуляр

Отображение идентификаторов в морфизмы состояния и другие вокабуляры.


# АВЧОМСМЫСОЛ?

## Идея

Цитирование - это базовая концепция языка, которая более или менее прямо
отображается на лямбду. Если быть точнее, то цитирование - это лямбда, которая
параметризованна потенциальнобесконечномерным аргументом. Этот аргумент -
вокабуляр. То есть `quotation -> vocabular -> stack -> stack`.

Обязательны функции прелюдии, которые принимают цитирование и подставляют
вместо каждого слова морфизм, подставляют морфизм вместо слов определенных
в данном вокабуляре (это прямо каррирование), схлопывают несколько морфизмов
в один, переставляют элементы цитат и так далее.

## Позднее связывание

Определения вроде
```
let [ my-word [ word0 word1 ] ]
```

связывают имя (в текущем вокабуляре) с цитированием, прямое выполенение вроде
`my-word` просто кладет цитирование на стек.

С другой стороны если мы определим два вокабуляра

```
let [ my-voc0 [
  let [ word0 dup + ]
  let [ word1 dup * ]
  ] ]
```

```
let [ my-voc1 [
  let [ word0 dup * ]
  let [ word1 dup + ]
  ]]
```

То можно сделать что-то вроде

```
10 my-word my-voc0 \ --> 400
10 my-word my-voc1 \ --> 200
```

Вокабуляры можно инклудить и реквайрить (это просто мапы, так что, почему нет?).
И значит

* Здесь есть ООП с любой формой наследования, какая нравится
* Здесь есть АДТ, потому что `let [ maybe-voc [ let just [ whatever ] let nothing [ whatever ] ] ]`
* Весь язык построен на абстракции построения ДСЛей.

## Макросы и комплияция

Вначале я хотел сделать макросы, как в Лиспе. Но они, вообще-то не нужны, потому что
цитирования - это и лямбды, и код лямбд. Единственная штука, которую надо сделать - это
макрос-чтения, который тоже не нужен, потому что всегда можно просто поменять местами цитату
и слово, которое с цитатой работает и получить нормальный такой дсл. Например, в языке
не будет слова `let` это `let [ name code ]` это `[ name code ] let-impl`.

Даже работа с цитированием предполагает, что компилятор что-то знает о среде исполнения.
Определение полноценных макросов чтения предполагает, что слова должны выполняться во время
компиляции => компиляция должна происходить на целевой платформе => жаваскрипт и кровь из глаз.


# Дальше

1. Я не до конца уверен, возможно при отказе от макросов появилась возможность при определении
слов одновременно хранить и цитирование, и морфизм. Это было бы очень хорошо, или нет.
2. Пользовательские типы данных, вообще определение данных. Это очень-очень тонкий момент, потому
что единственное место, где данные обитают - глобальное состояние. `1` - это морфизм, который
изменяет состояние, само понятие типа целого числа здесь даже более умозрительно, чем обычные
ярлычки на термах.
3. Интеграция с платформой, интерфейсы, прокси, протоколы там всякие. Зависит от пункта 2.
4. Типизация вокабуляров, структурный полиморфизм, рядовой полиморфизм, вот это вот все.
Типизация цитат. Это все зависит от состояния. `quotation -> vocabular -> state -> state`.
Единственное, что понятно, так это то, что цитаты и вокабуляры ортогональны.
5. Разрешение вокабуляров вокабулярами, цитирования, как вокабуляры синглтоны. Формальное
определение ортогональности цитат и вокабуляров.
